wgx:
  apiVersion: v1

tasks:
  smoke:
    cmd: "cargo test --workspace --tests -- --test-threads=1"
    safe: true

  guard:
    cmd: |
      cargo fmt --all --check
      cargo clippy --all-targets --all-features -- -D warnings
    safe: true

  metrics:
    cmd: |
      if [ -x scripts/wgx-metrics-snapshot.sh ]; then
        scripts/wgx-metrics-snapshot.sh --json
      else
        echo "no metrics script defined for heimlern; skipping"
      fi
    safe: true

  snapshot:
    cmd: echo "no snapshot task defined for heimlern; skipping"
    safe: true
